WITH MAX_PRICE_BY_CATEGORY AS (
  SELECT CATEGORY, MAX(PRICE) AS MAX_PRICE
  FROM FOOD_PRODUCT
  WHERE CATEGORY IN ('과자', '국', '김치', '식용유')
  GROUP BY CATEGORY
)

SELECT 
  F.CATEGORY, 
  F.PRICE AS MAX_PRICE, 
  F.PRODUCT_NAME
FROM FOOD_PRODUCT F
JOIN MAX_PRICE_BY_CATEGORY M
  ON F.CATEGORY = M.CATEGORY AND F.PRICE = M.MAX_PRICE
ORDER BY MAX_PRICE DESC;
